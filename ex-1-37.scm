;; Exercise 1.37
(define (cont-frac n d k)
  (define (frac i)
    (if (= i k)
      (/ (n i) (d i))
      (/ (n i)
         (+ (d i)
            (frac (+ i 1))))))
  (frac 1))

(define (cont-frac-i n d k)
  (define (iter i result)
    (if (= i 0)
      result
      (iter (- i 1) (/ (n i)
                       (+ (d i) result)))))
  (iter k 0))

(define (approx-golden-ratio k)
  (/ 1.0
     (cont-frac (lambda (i) 1.0)
                (lambda (i) 1.0)
                k)))

;; (use srfi-1)
;; (map approx-golden-ratio (iota 10 1))
;; (1.0 2.0 1.5 1.6666666666666665 1.6 1.625 1.6153846153846154 1.619047619047619 1.6176470588235294 1.6181818181818184)
;; (map approx-golden-ratio (iota 15 1))
;; (1.0 2.0 1.5 1.6666666666666665 1.6 1.625 1.6153846153846154 1.619047619047619 1.6176470588235294 1.6181818181818184 1.6179775280898876 1.6180555555555558 1.6180257510729614 1.6180371352785146 1.6180327868852458)
;; k = 12 でようやく小数点以下 4 桁まで合った。
;;
;; 1 / φ の近似
;; (map (lambda (k)
;;        (cont-frac (lambda (i) 1.0)
;;                   (lambda (i) 1.0)
;;                   k))
;;      (iota 15 1))
;; (1.0 0.5 0.6666666666666666 0.6000000000000001 0.625 0.6153846153846154 0.6190476190476191 0.6176470588235294 0.6181818181818182 0.6179775280898876 0.6180555555555556 0.6180257510729613 0.6180371352785146 0.6180327868852459 0.6180344478216819)
;; k = 11 で小数点以下 4 桁まで合った。
